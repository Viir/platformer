<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>

<body>

  <script src="pnglib.js"></script>
  <script>
    // var p = new PNGlib(10, 10, 256); // construcor takes height, weight and color-depth
    // var background = p.color(0, 0, 0, 0);
    // for (let i = 0; i < 10; i++) {
    //   for (let j = 0; j < 10; j++) {
    //     p.buffer[p.index(i, j)] = p.color(0x00, 0x44, 0xcc, 100);
    //   }
    // }
    // console.log(p.getDump())

    // https://www.xarg.org/2010/03/generate-client-side-png-files-using-javascript/
    var p = new PNGlib(200, 200, 256); // construcor takes height, weight and color-depth
    var background = p.color(0, 0, 0, 0); // set the background transparent



    for (var i = 0, num = 200 / 10; i <= num; i += .01) {

      var x = i * 10;
      var y = Math.sin(i) * Math.sin(i) * 50 + 50;

      // use a color triad of Microsofts million dollar color
      p.buffer[p.index(Math.floor(x), Math.floor(y - 10))] = p.color(0x00, 0x44, 0xcc);
      p.buffer[p.index(Math.floor(x), Math.floor(y))] = p.color(0xcc, 0x00, 0x44);
      p.buffer[p.index(Math.floor(x), Math.floor(y + 10))] = p.color(0x00, 0xcc, 0x44);
    }

    for (var i = 0; i < 50; i++) {
      for (var j = 0; j < 50; j++) {
        p.buffer[p.index(i + 90, j + 135)] = p.color(0xcc, 0x00, 0x44);
        p.buffer[p.index(i + 80, j + 120)] = p.color(0x00, 0x44, 0xcc);
        p.buffer[p.index(i + 100, j + 130)] = p.color(0x00, 0xcc, 0x44);
      }
    }


    document.write('<img src="data:image/png;base64,' + p.getBase64() + '">');
    // https://en.wikipedia.org/wiki/BMP_file_format

    const myData = [
      "42 4D",
      "46 00 00 00",
      "00 00",
      "00 00",
      "36 00 00 00",
      "28 00 00 00",
      "02 00 00 00",
      "02 00 00 00",
      "01 00",
      "18 00",
      "00 00 00 00",
      "10 00 00 00",
      "13 0B 00 00",
      "13 0B 00 00",
      "00 00 00 00",
      "00 00 00 00",
      "00 00 FF",
      "FF FF FF",
      "00 00",
      "FF 00 00",
      "00 FF 00",
      "00 00",
    ].join(" ").replace(/ /g, "\\x")
    // console.log(myData)
    const delme = "\x42\x4D\x46\x00\x00\x00\x00\x00\x00\x00\x36\x00\x00\x00\x28\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00\x01\x00\x18\x00\x00\x00\x00\x00\x10\x00\x00\x00\x13\x0B\x00\x00\x13\x0B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xFF\xFF\xFF\xFF\x00\x00\xFF\x00\x00\x00\xFF\x00\x00\x00"
    console.log(btoa(delme));
  </script>
</body>

</html>